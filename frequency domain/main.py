'''

Packages:
# Name                    Version                   Build  Channel
anaconda-client           1.9.0            py39haa95532_0
anaconda-navigator        2.1.4            py39haa95532_0
asn1crypto                1.4.0                      py_0    intel
attrs                     21.2.0             pyhd3eb1b0_0    intel
autopep8                  1.6.0              pyhd3eb1b0_0
backports                 1.1                pyhd3eb1b0_0
backports.functools_lru_cache 1.6.4              pyhd3eb1b0_0
backports.tempfile        1.0                pyhd3eb1b0_1
backports.weakref         1.0.post1                  py_1
beautifulsoup4            4.10.0             pyh06a4308_0
blas                      1.0                         mkl
bzip2                     1.0.8            vc14h53ad9d4_9  [vc14]  intel
ca-certificates           2021.10.26           haa95532_2    intel
certifi                   2021.10.8        py39haa95532_0    intel
cffi                      1.15.0           py39h2bbff1b_0    intel
chardet                   4.0.0           py39haa95532_1003    intel
click                     8.0.3              pyhd3eb1b0_0    intel
clyent                    1.2.2            py39haa95532_1
conda                     4.12.0           py39haa95532_0
conda-build               3.21.8           py39haa95532_2
conda-content-trust       0.1.1              pyhd3eb1b0_0
conda-env                 2.6.0                haa95532_1
conda-package-handling    1.7.3            py39h8cc25b3_1    intel
conda-repo-cli            1.0.4              pyhd3eb1b0_0
conda-token               0.3.0              pyhd3eb1b0_0
conda-verify              3.4.2                      py_1
console_shortcut          0.1.1                         4
cryptography              3.3.2            py39hf425351_1    intel
cudatoolkit               11.3.1               h59b6b97_2
cudnn                     8.2.1                cuda11.3_0
cycler                    0.11.0             pyhd3eb1b0_0    intel
dpcpp-cpp-rt              2022.0.0             intel_3663    intel
dpcpp_cpp_rt              2022.0.0             intel_3663    intel
eigen                     3.3.7                h59b6b97_1
ffmpeg                    4.2.2                he774522_0
filelock                  3.6.0              pyhd3eb1b0_0
freeglut                  3.0.0                h6538335_5
freetype                  2.10.4               h43e298c_0    intel
future                    0.18.2           py39haa95532_1
git                       2.24.0                        1    conda-forge
git-bash                  2.24.0                        0    conda-forge
glob2                     0.7                pyhd3eb1b0_0
icc_rt                    2022.0.0             intel_3663    intel
icu                       68.1                 h6c2663c_0
idna                      2.10               pyhd3eb1b0_0    intel
importlib-metadata        4.11.3           py39haa95532_0
importlib_metadata        4.11.3               hd3eb1b0_0
intel-cmplr-lib-rt        2022.0.0             intel_3663    intel
intel-cmplr-lic-rt        2022.0.0             intel_3663    intel
intel-opencl-rt           2022.0.0             intel_3663    intel
intel-openmp              2022.0.0             intel_3663    intel
intelpython               2022.0.0                      0    intel
ipython_genutils          0.2.0              pyhd3eb1b0_1
jasper                    2.0.14               hea7d32e_2
jinja2                    2.11.3             pyhd3eb1b0_0
jpeg                      9d                   h2bbff1b_0
jsonschema                3.2.0              pyhd3eb1b0_2
jupyter_core              4.9.2            py39haa95532_0
kiwisolver                1.3.1            py39hd77b12b_0    intel
libarchive                3.5.2                hec01699_0    intel
libblas                   3.9.0              13_win64_mkl    conda-forge
libcblas                  3.9.0              13_win64_mkl    conda-forge
libclang                  11.1.0          default_h5c34c98_1    conda-forge
libiconv                  1.16                 h2beac5e_1    intel
liblapack                 3.9.0              13_win64_mkl    conda-forge
liblapacke                3.9.0              13_win64_mkl    conda-forge
liblief                   0.11.5               hd77b12b_1
libopencv                 4.5.0                    py39_2    conda-forge
libpng                    1.6.37           vc14h53ad9d4_8  [vc14]  intel
libtiff                   4.2.0                hd0e1b90_0
libuv                     1.40.0               he774522_0
libwebp                   1.2.2                h2bbff1b_0
libwebp-base              1.2.2                h2bbff1b_0
libxml2                   2.9.12               h8f7f88b_1    intel
lz4-c                     1.9.3                h2bbff1b_1    intel
lzo                       2.10                 hb535718_6    intel
markupsafe                2.0.1            py39h2bbff1b_0
matplotlib                3.1.2           py39h3292d09_11    intel
menuinst                  1.4.18           py39h59b6b97_0    intel
mkl                       2022.0.0           h0e2418a_796    conda-forge
mkl-service               2.4.0           py39h9dd93ce_10    intel
mkl_fft                   1.3.1            py39hd8013da_7    intel
mkl_random                1.2.2            py39he911e3a_7    intel
mkl_umath                 0.1.1           py39h4dc28bd_17    intel
navigator-updater         0.2.1                    py39_1
nbformat                  5.1.3              pyhd3eb1b0_0
ninja                     1.10.2           py39h559b2a2_3
numpy                     1.21.2           py39hec4e512_7    intel
numpy-base                1.21.2           py39h54dbe16_7    intel
openjdk                   11.0.13              h2bbff1b_0
openssl                   1.1.1n               h2bbff1b_0
packaging                 21.0             py39h1546d3d_4    intel
pillow                    9.0.1            py39hdc2b20a_0
pip                       21.2.4           py39haa95532_0    intel
pkginfo                   1.8.2              pyhd3eb1b0_0
powershell_shortcut       0.0.1                         3
psutil                    5.8.0            py39h2bbff1b_1
py-lief                   0.11.5           py39hd77b12b_1
py-opencv                 4.5.0            py39h9cd51e4_2    conda-forge
pycodestyle               2.8.0              pyhd3eb1b0_0
pycosat                   0.6.3            py39h2bbff1b_0    intel
pycparser                 2.21               pyhd3eb1b0_0    intel
pyjwt                     2.1.0              pyhd8ed1ab_0    intel
pyopenssl                 21.0.0             pyhd3eb1b0_1    intel
pyparsing                 3.0.4              pyhd3eb1b0_0    intel
pyqt                      5.12.3           py39hcbf5309_8    conda-forge
pyqt-impl                 5.12.3           py39h415ef7b_8    conda-forge
pyqt5-sip                 4.19.18          py39h415ef7b_8    conda-forge
pyqtchart                 5.12             py39h415ef7b_8    conda-forge
pyqtwebengine             5.12.1           py39h415ef7b_8    conda-forge
pyrsistent                0.18.0           py39h196d8e1_0
pysocks                   1.7.1            py39haa95532_0    intel
python                    3.9.10               h6cc024a_1    intel
python-dateutil           2.8.2                    py39_1    intel
python-libarchive-c       2.9                pyhd3eb1b0_1    intel
python_abi                3.9                      2_cp39    conda-forge
pytorch                   1.10.0          py3.9_cuda11.3_cudnn8_0    pytorch
pytorch-mutex             1.0                        cuda    pytorch
pytz                      2021.3             pyhd3eb1b0_0    intel
pywin32                   228              py39hbaba5e8_1    intel
pyyaml                    6.0              py39h2bbff1b_1    intel
qt                        5.12.9               h5909a2a_4    conda-forge
qtpy                      2.0.1              pyhd3eb1b0_0
requests                  2.25.1             pyhd3eb1b0_0    intel
ruamel_yaml               0.15.100         py39h2bbff1b_0    intel
selenium                  3.141.0         py39h2bbff1b_1000
setuptools                58.0.4           py39haa95532_0    intel
six                       1.16.0             pyhd3eb1b0_0    intel
soupsieve                 2.3.1              pyhd3eb1b0_0
sqlite                    3.38.2               h2bbff1b_0
tbb                       2021.5.0         vc14_intel_714  [vc14]  intel
tbb4py                    2021.5.0         py39_intel_714  [vc14]  intel
tcl                       8.6.10                   vc14_2  [vc14]  intel
tk                        8.6.10               he774522_3    intel
toml                      0.10.2             pyhd3eb1b0_0
torchaudio                0.10.0               py39_cu113    pytorch
torchvision               0.11.1               py39_cu113    pytorch
tqdm                      4.62.3             pyhd3eb1b0_1    intel
traitlets                 5.1.1              pyhd3eb1b0_0
typing_extensions         3.7.4.3            pyha847dfd_0    intel
ujson                     5.1.0            py39hd77b12b_0
urllib3                   1.26.6           py39h6fed32d_1    intel
vc                        14.2                 h21ff451_1    intel
vs2015_runtime            14.27.29016          h5e58377_2    intel
wheel                     0.37.0             pyhd3eb1b0_1    intel
win_inet_pton             1.1.0            py39haa95532_0    intel
wincertstore              0.2              py39haa95532_2    intel
xz                        5.2.5                h1ce30a1_2    intel
yaml                      0.2.5                he774522_0    intel
zipp                      3.6.0              pyhd3eb1b0_0    intel
zlib                      1.2.11.1         vc14hc1c5f5b_5  [vc14]  intel
zstd                      1.4.5                h9ae49aa_0    intel

------------------
System Information
------------------
      Time of this report: 4/6/2022, 12:24:06
             Machine name: ELITEBOOK
               Machine Id: {9131A80F-3366-4796-BD53-EA7FCCF25399}
         Operating System: Windows 11 专业版 64-bit (10.0, Build 22000) (22000.co_release.210604-1628)
                 Language: Chinese (Simplified) (Regional Setting: Chinese (Simplified))
      System Manufacturer: HP
             System Model: HP EliteBook 1050 G1
                     BIOS: Q72 Ver. 01.19.00 (type: UEFI)
                Processor: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz (12 CPUs), ~2.2GHz
                   Memory: 32768MB RAM
      Available OS Memory: 32574MB RAM
                Page File: 13557MB used, 23881MB available
              Windows Dir: C:\WINDOWS
          DirectX Version: DirectX 12
      DX Setup Parameters: Not found
         User DPI Setting: 120 DPI (125 percent)
       System DPI Setting: 120 DPI (125 percent)
          DWM DPI Scaling: UnKnown
                 Miracast: Available, with HDCP
Microsoft Graphics Hybrid: Supported
 DirectX Database Version: 1.3.5
           DxDiag Version: 10.00.22000.0001 64bit Unicode

---------------
Display Devices
---------------
           Card name: Intel(R) UHD Graphics 630
        Manufacturer: Intel Corporation
           Chip type: Intel(R) UHD Graphics Family
            DAC type: Internal
         Device Type: Full Device (POST)
          Device Key: Enum\PCI\VEN_8086&DEV_3E9B&SUBSYS_84E9103C&REV_00
       Device Status: 0180200A [DN_DRIVER_LOADED|DN_STARTED|DN_DISABLEABLE|DN_NT_ENUMERATOR|DN_NT_DRIVER]
 Device Problem Code: No Problem
 Driver Problem Code: Unknown
      Display Memory: 16415 MB
    Dedicated Memory: 128 MB
       Shared Memory: 16287 MB
        Current Mode: 1920 x 1080 (32 bit) (60Hz)
         HDR Support: Not Supported
    Display Topology: Internal
 Display Color Space: DXGI_COLOR_SPACE_RGB_FULL_G22_NONE_P709
     Color Primaries: Red(0.639648,0.330078), Green(0.299805,0.599609), Blue(0.149414,0.059570), White Point(0.312500,0.329102)
   Display Luminance: Min Luminance = 0.500000, Max Luminance = 270.000000, MaxFullFrameLuminance = 270.000000
        Monitor Name: Generic PnP Monitor
       Monitor Model: unknown
          Monitor Id: LGD05A9
         Native Mode: 1920 x 1080(p) (59.977Hz)
         Output Type: Internal
Monitor Capabilities: HDR Not Supported
Display Pixel Format: DISPLAYCONFIG_PIXELFORMAT_32BPP
      Advanced Color: Not Supported
         Driver Name: C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igdumdim64.dll,C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igd10iumd64.dll,C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igd10iumd64.dll,C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igd12umd64.dll
 Driver File Version: 30.00.0101.1340 (English)
      Driver Version: 30.0.101.1340
         DDI Version: 12
      Feature Levels: 12_1,12_0,11_1,11_0,10_1,10_0,9_3,9_2,9_1
        Driver Model: WDDM 3.0
 Hardware Scheduling: DriverSupportState:AlwaysOff Enabled:False
 Graphics Preemption: Triangle
  Compute Preemption: Thread
            Miracast: Supported
      Detachable GPU: No
 Hybrid Graphics GPU: Integrated
      Power P-states: Not Supported
      Virtualization: Paravirtualization
          Block List: DISABLE_HWSCH
  Catalog Attributes: Universal:False Declarative:True
   Driver Attributes: Final Retail
    Driver Date/Size: 2022/2/3 8:00:00, 1702664 bytes
         WHQL Logo'd: Yes
     WHQL Date Stamp: Unknown
   Device Identifier: {D7B78E66-7DDB-11CF-B076-8CA4AFC2D335}
           Vendor ID: 0x8086
           Device ID: 0x3E9B
           SubSys ID: 0x84E9103C
         Revision ID: 0x0000
  Driver Strong Name: oem121.inf:5f63e53429d61c21:iCFL_w10_DS:30.0.101.1340:PCI\VEN_8086&DEV_3E9B
      Rank Of Driver: 00CF2001
         Video Accel: ModeMPEG2_A ModeMPEG2_C ModeWMV9_C ModeVC1_C
         DXVA2 Modes: DXVA2_ModeMPEG2_VLD  DXVA2_ModeMPEG2_IDCT  DXVA2_ModeVC1_D2010  {E07EC519-E651-4CD6-AC84-1370CCEEC851}  {BCC5DB6D-A2B6-4AF0-ACE4-ADB1F787BC89}  DXVA2_ModeWMV9_IDCT  DXVA2_ModeVC1_IDCT  DXVA2_ModeH264_VLD_NoFGT  DXVA2_ModeH264_VLD_Stereo_Progressive_NoFGT  DXVA2_ModeH264_VLD_Stereo_NoFGT  DXVA2_ModeH264_VLD_Multiview_NoFGT  {C528916C-C0AF-4645-8CB2-372B6D4ADC2A}  {91CD2D6E-897B-4FA1-B0D7-51DC88010E0A}  DXVA2_ModeVP8_VLD  {442B942A-B4D9-4940-BC45-A882E5F919F3}  {97688186-56A8-4094-B543-FC9DAAA49F4B}  {1424D4DC-7CF5-4BB1-9CD7-B63717A72A6B}  {C346E8A3-CBED-4D27-87CC-A70EB4DC8C27}  {FFC79924-5EAF-4666-A736-06190F281443}  {2364D06A-F67F-4186-AED0-62B99E1784F1}  {464BDB3C-91C4-4E9B-896F-225496AC4ED6}  {28566328-F041-4466-8B14-8F5831E78F8B}  {6B4A94DB-54FE-4AE1-9BE4-7A7DAD004600}  {8C56EB1E-2B47-466F-8D33-7DBCD63F3DF2}  DXVA2_ModeHEVC_VLD_Main  {75FC75F7-C589-4A07-A25B-72E03B0383B3}  DXVA2_ModeHEVC_VLD_Main10  {07CFAFFB-5A2E-4B99-B62A-E4CA53B6D5AA}  DXVA2_ModeVP9_VLD_Profile0  DXVA2_ModeVP9_VLD_10bit_Profile2  {76988A52-DF13-419A-8E64-FFCF4A336CF5}  {80A3A7BD-89D8-4497-A2B8-2126AF7E6EB8}  {50925B7B-E931-4978-A12A-586630F095F9}  {B69C20E0-2508-8790-0305-875499E0A2D0}  {49761BEC-4B63-4349-A5FF-87FFDF088466}
   Deinterlace Caps: {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(UYVY,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(UYVY,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(UYVY,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(YV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(YV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(NV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(NV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(NV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC1,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC1,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC1,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC2,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC3,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC3,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC3,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC4,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC4,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC4,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
        D3D9 Overlay: Supported
             DXVA-HD: Supported
        DDraw Status: Enabled
          D3D Status: Enabled
          AGP Status: Enabled
       MPO MaxPlanes: 3
            MPO Caps: RGB,YUV,BILINEAR,HIGH_FILTER,STRETCH_YUV,STRETCH_RGB,IMMEDIATE,HDR (MPO3)
         MPO Stretch: 5.000X - 0.334X
     MPO Media Hints: colorspace Conversion
         MPO Formats: NV12,YUY2,R16G16B16A16_FLOAT,R10G10B10A2_UNORM,R8G8B8A8_UNORM,B8G8R8A8_UNORM
    PanelFitter Caps: RGB,YUV,BILINEAR,HIGH_FILTER,STRETCH_YUV,STRETCH_RGB,IMMEDIATE,HDR (MPO3)
 PanelFitter Stretch: 5.000X - 0.334X
   Component Drivers:
             Driver Name: Unknown
          Driver Version: Unknown
             Driver Date: Unknown
         Driver Provider: Unknown
      Catalog Attributes: N/A
             Driver Name: Unknown
          Driver Version: Unknown
             Driver Date: Unknown
         Driver Provider: Unknown
      Catalog Attributes: N/A

           Card name: NVIDIA GeForce GTX 1050 with Max-Q Design
        Manufacturer: NVIDIA
           Chip type: NVIDIA GeForce GTX 1050 with Max-Q Design
            DAC type: Integrated RAMDAC
         Device Type: Full Device
          Device Key: Enum\PCI\VEN_10DE&DEV_1C8D&SUBSYS_84E9103C&REV_A1
       Device Status: 0180200A [DN_DRIVER_LOADED|DN_STARTED|DN_DISABLEABLE|DN_NT_ENUMERATOR|DN_NT_DRIVER]
 Device Problem Code: No Problem
 Driver Problem Code: Unknown
      Display Memory: 20306 MB
    Dedicated Memory: 4019 MB
       Shared Memory: 16287 MB
        Current Mode: Unknown
         HDR Support: Unknown
    Display Topology: Unknown
 Display Color Space: Unknown
     Color Primaries: Unknown
   Display Luminance: Unknown
         Driver Name: C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll,C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll,C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll,C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll
 Driver File Version: 30.00.0015.1006 (English)
      Driver Version: 30.0.15.1006
         DDI Version: 12
      Feature Levels: 12_1,12_0,11_1,11_0,10_1,10_0,9_3,9_2,9_1
        Driver Model: WDDM 3.0
 Hardware Scheduling: DriverSupportState:Stable Enabled:True
 Graphics Preemption: Pixel
  Compute Preemption: Dispatch
            Miracast: Not Supported by Graphics driver
      Detachable GPU: No
 Hybrid Graphics GPU: Discrete
      Power P-states: Not Supported
      Virtualization: Paravirtualization
          Block List: No Blocks
  Catalog Attributes: Universal:False Declarative:True
   Driver Attributes: Final Retail
    Driver Date/Size: 2021/8/24 8:00:00, 1056920 bytes
         WHQL Logo'd: Yes
     WHQL Date Stamp: Unknown
   Device Identifier: Unknown
           Vendor ID: 0x10DE
           Device ID: 0x1C8D
           SubSys ID: 0x84E9103C
         Revision ID: 0x00A1
  Driver Strong Name: oem21.inf:0f066de303554110:Section032:30.0.15.1006:pci\ven_10de&dev_1c8d&subsys_84e9103c
      Rank Of Driver: 00CF0001
         Video Accel: Unknown
         DXVA2 Modes: {86695F12-340E-4F04-9FD3-9253DD327460}  DXVA2_ModeMPEG2_VLD  {6F3EC719-3735-42CC-8063-65CC3CB36616}  DXVA2_ModeVC1_D2010  DXVA2_ModeVC1_VLD  {32FCFE3F-DE46-4A49-861B-AC71110649D5}  DXVA2_ModeH264_VLD_Stereo_Progressive_NoFGT  DXVA2_ModeH264_VLD_Stereo_NoFGT  DXVA2_ModeH264_VLD_NoFGT  DXVA2_ModeHEVC_VLD_Main  DXVA2_ModeHEVC_VLD_Main10  {20BB8B0A-97AA-4571-8E99-64E60606C1A6}  {15DF9B21-06C4-47F1-841E-A67C97D7F312}  DXVA2_ModeMPEG4pt2_VLD_Simple  DXVA2_ModeMPEG4pt2_VLD_AdvSimple_NoGMC  {9947EC6F-689B-11DC-A320-0019DBBC4184}  {33FCFE41-DE46-4A49-861B-AC71110649D5}  DXVA2_ModeVP9_VLD_Profile0  DXVA2_ModeVP9_VLD_10bit_Profile2  {DDA19DC7-93B5-49F5-A9B3-2BDA28A2CE6E}  {6AFFD11E-1D96-42B1-A215-93A31F09A53D}  {914C84A3-4078-4FA9-984C-E2F262CB5C9C}
      Deinterlace Caps: n/a
        D3D9 Overlay: Unknown
             DXVA-HD: Unknown
        DDraw Status: Enabled
          D3D Status: Enabled
          AGP Status: Enabled
       MPO MaxPlanes: 0
            MPO Caps: Not Supported
         MPO Stretch: Not Supported
     MPO Media Hints: Not Supported
         MPO Formats: Not Supported
    PanelFitter Caps: Not Supported
 PanelFitter Stretch: Not Supported

-------------
Sound Devices
-------------
            Description: 扬声器 (Conexant ISST Audio)
 Default Sound Playback: Yes
 Default Voice Playback: Yes
            Hardware ID: INTELAUDIO\FUNC_01&VEN_14F1&DEV_20D0&SUBSYS_103C84E9&REV_1000
        Manufacturer ID: N/A
             Product ID: N/A
                   Type: N/A
            Driver Name: CHDRT64ISST.sys
         Driver Version: 9.0.278.150 (Chinese (Simplified))
      Driver Attributes: Final Retail
            WHQL Logo'd: Yes
          Date and Size: 2021/11/18 8:00:00, 2521920 bytes
            Other Files:
        Driver Provider: Conexant
         HW Accel Level: Emulation Only
              Cap Flags: 0xF1F
    Min/Max Sample Rate: 100, 200000
Static/Strm HW Mix Bufs: 1, 0
 Static/Strm HW 3D Bufs: 0, 0
              HW Memory: 0
       Voice Management: No
 EAX(tm) 2.0 Listen/Src: No, No
   I3DL2(tm) Listen/Src: No, No
Sensaura(tm) ZoomFX(tm): No

---------------------
Sound Capture Devices
---------------------
            Description: 麦克风 (Conexant ISST Audio)
  Default Sound Capture: Yes
  Default Voice Capture: Yes
            Driver Name: CHDRT64ISST.sys
         Driver Version: 9.0.278.150 (Chinese (Simplified))
      Driver Attributes: Final Retail
          Date and Size: 2021/11/18 8:00:00, 2521920 bytes
              Cap Flags: 0x1
           Format Flags: 0xFFFFF

-------------------
DirectInput Devices
-------------------
      Device Name: 鼠标
         Attached: 1
    Controller ID: n/a
Vendor/Product ID: n/a
        FF Driver: n/a

      Device Name: 键盘
         Attached: 1
    Controller ID: n/a
Vendor/Product ID: n/a
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: HP Wireless Button Driver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x0001, 0x0001
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: HIDI2C Device
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x06CB, 0xCD46
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: HIDI2C Device
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x06CB, 0xCD46
        FF Driver: n/a

Poll w/ Interrupt: No

-----------
USB Devices
-----------
+ USB 根集线器(USB 3.0)
| Vendor/Product ID: 0x8086, 0xA36D
| Matching Device ID: USB\ROOT_HUB30
| Service: USBHUB3
| Driver: USBHUB3.SYS, 8/1/2021 11:33:15, 696656 bytes
|
+-+ USB Composite Device
| | Vendor/Product ID: 0x046D, 0xC53F
| | Location: Port_#0005.Hub_#0001
| | Matching Device ID: USB\COMPOSITE
| | Service: usbccgp
| | Driver: usbccgp.sys, 6/5/2021 20:04:46, 221512 bytes
| |
| +-+ USB 输入设备
| | | Vendor/Product ID: 0x046D, 0xC53F
| | | Location: 0000.0014.0000.005.000.000.000.000.000
| | | Matching Device ID: USB\Class_03&SubClass_01
| | | Service: HidUsb
| | | Driver: hidusb.sys, 6/5/2021 20:04:46, 73728 bytes
| | | Driver: hidclass.sys, 6/5/2021 20:04:46, 274432 bytes
| | | Driver: hidparse.sys, 6/5/2021 20:04:46, 77824 bytes
| | |
| | +-+ HID Keyboard Device
| | | | Vendor/Product ID: 0x046D, 0xC53F
| | | | Matching Device ID: HID_DEVICE_SYSTEM_KEYBOARD
| | | | Service: kbdhid
| | | | Driver: kbdhid.sys, 6/5/2021 20:04:46, 69632 bytes
| | | | Driver: kbdclass.sys, 6/5/2021 20:04:46, 90424 bytes
| | |
| +-+ USB 输入设备
| | | Vendor/Product ID: 0x046D, 0xC53F
| | | Location: 0000.0014.0000.005.000.000.000.000.000
| | | Matching Device ID: USB\Class_03&SubClass_01
| | | Service: HidUsb
| | | Driver: hidusb.sys, 6/5/2021 20:04:46, 73728 bytes
| | | Driver: hidclass.sys, 6/5/2021 20:04:46, 274432 bytes
| | | Driver: hidparse.sys, 6/5/2021 20:04:46, 77824 bytes
| | |
| | +-+ HID-compliant mouse
| | | | Vendor/Product ID: 0x046D, 0xC53F
| | | | Matching Device ID: HID_DEVICE_SYSTEM_MOUSE
| | | | Service: mouhid
| | | | Driver: mouhid.sys, 6/5/2021 20:04:46, 65536 bytes
| | | | Driver: mouclass.sys, 6/5/2021 20:04:46, 90448 bytes

------------
PS/2 Devices
------------
+ Standard 101/102-Key or Microsoft Natural PS/2 Keyboard for HP Hotkey Support
| Matching Device ID: ACPI\HPQ8002
| Upper Filters: HpqKbFiltr
| Service: i8042prt
| Driver: HpqKbFiltr.sys, 10/30/2021 14:34:06, 54688 bytes
| Driver: i8042prt.sys, 6/5/2021 20:04:46, 155648 bytes
| Driver: kbdclass.sys, 6/5/2021 20:04:46, 90424 bytes
|
+ Synaptics HID ClickPad
| Vendor/Product ID: 0x06CB, 0x0000
| Matching Device ID: HID\SYNA307B&Col01
| Upper Filters: SynTP
| Service: mouhid
| Driver: SynTP.sys, 1/20/2021 23:58:02, 762256 bytes
| Driver: SynTPEnh.exe, 1/20/2021 23:58:04, 4287888 bytes
| Driver: SynTPRes.dll, 1/20/2021 23:58:02, 19816336 bytes
| Driver: SynTPAPI.dll, 1/20/2021 23:58:00, 275344 bytes
| Driver: SynCOM.dll, 1/20/2021 23:57:56, 810384 bytes
| Driver: SynTPEnhService.exe, 1/20/2021 23:58:00, 342416 bytes
| Driver: mouhid.sys, 6/5/2021 20:04:46, 65536 bytes
| Driver: mouclass.sys, 6/5/2021 20:04:46, 90448 bytes
|
+ PS/2 兼容鼠标
| Matching Device ID: *PNP0F13
| Service: i8042prt
| Driver: mouclass.sys, 6/5/2021 20:04:46, 90448 bytes
| Driver: i8042prt.sys, 6/5/2021 20:04:46, 155648 bytes

------------------------
Disk & DVD/CD-ROM Drives
------------------------
      Drive: C:
 Free Space: 359.5 GB
Total Space: 952.9 GB
File System: NTFS
      Model: Intel Raid 1 Volume

'''


import cv2
import numpy as np
from enum import Enum


BorderTypes = Enum(
    'BorderTypes', ('BORDER_CONSTANT BORDER_REPLICATE'))  # 预定义可能的边界类型


def BGR2GRAY(src: np.ndarray) -> np.ndarray:
    '''将RGB图转为8位灰度图'''

    tmp = src.astype(np.uint32)  # 用32位整型存储防止溢出

    # RGB to Gray: Y←0.299⋅R+0.587⋅G+0.114⋅B
    return ((tmp[:, :, 2]*299 + tmp[:, :, 1]*587 + tmp[:, :, 0]*114+500)//1000).astype(np.uint8)


def copyMakeBorder(src: np.ndarray, top: int, bottom: int, left: int, right: int,
                   borderType: BorderTypes, value: int = 0) -> np.ndarray:
    '''图像边缘填充'''

    height, width = src.shape  # 获得原图长宽

    dst = np.empty((height+top+bottom, width+left+right),
                   dtype=src.dtype)  # 分配空间
    dst[top: height+top, left: width+left] = src.copy()  # 载入原图

    if borderType is BorderTypes.BORDER_CONSTANT:  # iiiiii|abcdefgh|iiiiiii with i specified by value
        # pad top
        dst[:top, left: width+left] = value
        # pad bottom
        dst[height+top:, left: width+left] = value
        # pad left
        dst[:, :left] = value
        # pad right
        dst[:, width+left:] = value

    elif borderType is BorderTypes.BORDER_REPLICATE:  # aaaaaa|abcdefgh|hhhhhhh

        # pad top
        dst[:top, left: width + left] = np.tile(
            dst[top, left: width+left].reshape(1, -1), (top, 1))

        # pad bottom
        dst[height+top:, left: width +
            left] = np.tile(
                dst[height+top-1, left: width+left].reshape(1, -1), (bottom, 1))

        # pad left
        dst[:, :left] = np.tile(
            dst[:, left].reshape(-1, 1), (1, left))

        # pad right
        dst[:, width+left:] = np.tile(
            dst[:, width+left-1].reshape(-1, 1), (1, right))

    return dst  # return result


def rangeFilter(src: np.ndarray, kth: int, kSize: int = 3) -> np.ndarray:
    '''排序滤波'''

    height, width = src.shape  # 获得图像长宽
    imgPadded = copyMakeBorder(
        src,  kSize//2, kSize//2, kSize//2, kSize//2, BorderTypes.BORDER_REPLICATE)  # 边缘填充
    dst = np.empty_like(src, dtype=src.dtype)  # allocate memory for result

    # filtering
    for y in range(height):  # 对所有行
        for x in range(width):  # 对所有列
            # 选取窗口中从小往大数kth位的像素值
            dst[y, x] = np.partition(
                imgPadded[y: y + kSize, x: x + kSize].flatten(), kth)[kth]

    return dst  # return result


def dilate(src: np.ndarray, ksize: int = 3) -> np.ndarray:
    '''灰度图膨胀'''

    return rangeFilter(src, -1, ksize)  # 3x3的全部的结构化元素，取结构化元素在对象区域中的最大值


def erode(src: np.ndarray, ksize: int = 3) -> np.ndarray:
    '''灰度图腐蚀'''

    return rangeFilter(src, 0, ksize)  # 3x3的全部的结构化元素，取结构化元素在对象区域中的最小值


def open(src: np.ndarray, ksize: int = 3) -> np.ndarray:
    '''灰度图开运算'''

    return dilate(erode(src, ksize), ksize)  # 开运算即先腐蚀后膨胀


def close(src: np.ndarray, ksize: int = 3) -> np.ndarray:
    '''灰度图闭运算'''

    return erode(dilate(src, ksize), ksize)  # 闭运算即先膨胀后腐蚀


def topHat(src: np.ndarray, ksize: int = 3) -> np.ndarray:
    '''灰度图顶帽运算'''

    return src-open(src, ksize)  # 顶帽运算即原图减去原图开运算后的结果


def blackHat(src: np.ndarray, ksize: int = 3) -> np.ndarray:
    '''灰度图黑帽运算'''

    return close(src, ksize)-src  # 黑帽运算即原图闭运算后的结果减去原图


def logMagnitude(src: np.ndarray) -> np.ndarray:
    '''输入频域表示，输出对数表示形式且归一化的幅值谱'''

    dst = np.fft.fftshift(src)  # 零点移至中心
    dst = np.log(np.abs(dst)+1)  # 对数形式表示
    dst = dst/dst.max()*255  # 最大值归一化并放缩到图片显示范围
    dst = dst.astype(np.uint8)  # 强制类型转换

    return dst  # return result


def freq2Space(src: np.ndarray, kSize: int) -> np.ndarray:
    '''频谱转回空间域图像，裁剪到原图大小'''

    dst = np.fft.ifft2(src)  # 计算傅里叶逆变换
    # 转为实数后截断并取整及裁剪
    dst = np.abs(dst).clip(0, 255).astype(
        np.uint8)[kSize//2:-(kSize//2), kSize//2:-(kSize//2)]

    return dst  # return result


def main() -> None:
    # Read origin image
    imgOrig = cv2.imread("./src/origin_image.png")
    imgOrigGray = BGR2GRAY(imgOrig)  # grayscale

    # Read image with guassian noise
    imgGaus = cv2.imread("./src/gaussian_noise.png")
    imgGausGray = BGR2GRAY(imgGaus)  # grayscale

    # Read image with pepper noise
    imgPep = cv2.imread("./src/pepper_noise.png")
    imgPepGray = BGR2GRAY(imgPep)  # grayscale

    kSize = 3  # 窗口大小为3x3

    # Dilating orig
    imgDilateOrig = dilate(imgOrigGray, kSize)
    # Dilated
    cv2.imwrite("./dst/3x3_dilate_origin.png", imgDilateOrig)
    # Dilating Gaussian noise
    imgDilateGaus = dilate(imgGausGray, kSize)
    # Dilated
    cv2.imwrite("./dst/3x3_dilate_gaussian.png", imgDilateGaus)
    # Dilating pepper noise
    imgDilatePep = dilate(imgPepGray, kSize)
    # Dilated
    cv2.imwrite("./dst/3x3_dilate_pepper.png", imgDilatePep)

    # Eroding orig
    imgErodeOrig = erode(imgOrigGray, kSize)
    # Eroded
    cv2.imwrite("./dst/3x3_erode_origin.png", imgErodeOrig)
    # Eroding Gaussian noise
    imgErodeGaus = erode(imgGausGray, kSize)
    # Eroded
    cv2.imwrite("./dst/3x3_erode_gaussian.png", imgErodeGaus)
    # Eroding pepper noise
    imgErodePep = erode(imgPepGray, kSize)
    # Eroded
    cv2.imwrite("./dst/3x3_erode_pepper.png", imgErodePep)

    # Top hatting orig
    imgTopHatOrig = topHat(imgOrigGray, kSize)
    # Top hatted
    cv2.imwrite("./dst/3x3_topHat_origin.png", imgTopHatOrig)
    # Top hatting Gaussian noise
    imgTopHatGaus = topHat(imgGausGray, kSize)
    # Top hatted
    cv2.imwrite("./dst/3x3_topHat_gaussian.png", imgTopHatGaus)
    # Top hatting pepper noise
    imgTopHatPep = topHat(imgPepGray, kSize)
    # Top hatted
    cv2.imwrite("./dst/3x3_topHat_pepper.png", imgTopHatPep)

    # Black hatting orig
    imgBlackHatOrig = blackHat(imgOrigGray, kSize)
    # Black hatted
    cv2.imwrite("./dst/3x3_blackHat_origin.png", imgBlackHatOrig)
    # Black hatting Gaussian noise
    imgBlackHatGaus = blackHat(imgGausGray, kSize)
    # Black hatted
    cv2.imwrite("./dst/3x3_blackHat_gaussian.png", imgBlackHatGaus)
    # Black hatting pepper noise
    imgBlackHatPep = blackHat(imgPepGray, kSize)
    # Black hatted
    cv2.imwrite("./dst/3x3_blackHat_pepper.png", imgBlackHatPep)

    SobelXKernel = np.array([[1, 0, -1],
                             [2, 0, -2],
                             [1, 0, -1]], dtype=np.int8)  # x方向Sobel滤波器的卷积核，和OpenCV实现保持一致而未做归一化
    SobelYKernel = np.array([[1, 2, 1],
                             [0, 0, 0],
                             [-1, -2, -1]], dtype=np.int8)  # y方向Sobel滤波器的卷积核，和OpenCV实现保持一致而未做归一化

    sigma = 3  # 经测试，该σ值效果较好，既保留细节又滤除高斯噪声
    GaussianKernel = np.empty(
        (kSize, kSize), dtype=np.float16)  # 为高斯滤波器的卷积核分配空间
    cter = kSize // 2  # 卷积核的中心位置
    for i in range(kSize):  # 对卷积核的每行
        for j in range(kSize):  # 对卷积核的每列
            # 计算卷积核中每个元素的值，注意到(1/2πσ)系数的计算是不必要的，因为会在归一化中被消去
            GaussianKernel[i][j] = np.exp(
                -((i-cter) ** 2+(j-cter)**2) / (2*sigma**2))
    GaussianKernel /= GaussianKernel.sum()  # 归一化，避免影响图像明度

    LaplacianKernel = np.array([[0, 1, 0],
                                [1, -4, 1],
                                [0, 1, 0]], dtype=np.int8)  # 2D拉普拉斯滤波器的卷积核，和OpenCV实现保持一致而未做归一化

    height, width = imgOrigGray.shape  # 获取原图长宽
    top = 0  # 计算上侧填充大小
    left = 0  # 计算左侧填充大小
    bottom = height-1  # 计算下侧填充大小
    right = width-1  # 计算右侧填充大小

    # 原图补零
    imgOrigPadded = copyMakeBorder(
        imgOrigGray,  kSize//2, kSize//2, kSize//2, kSize//2, BorderTypes.BORDER_REPLICATE)
    # 带高斯噪声图补零
    imgGausPadded = copyMakeBorder(
        imgGausGray,  kSize//2, kSize//2, kSize//2, kSize//2, BorderTypes.BORDER_REPLICATE)
    # 带椒盐噪声图补零
    imgPepPadded = copyMakeBorder(
        imgPepGray,  kSize//2, kSize//2, kSize//2, kSize//2, BorderTypes.BORDER_REPLICATE)
    # x方向Sobel滤波器的卷积核补零
    SobelXPadded = copyMakeBorder(
        SobelXKernel, top, bottom, left, right, borderType=BorderTypes.BORDER_CONSTANT, value=0)
    # 循环移位，使原点对齐左上角
    SobelXPadded = np.roll(
        np.roll(SobelXPadded, -(kSize//2), axis=0), -(kSize//2), axis=1)
    # y方向Sobel滤波器的卷积核补零
    SobelYPadded = copyMakeBorder(
        SobelYKernel, top, bottom, left, right, borderType=BorderTypes.BORDER_CONSTANT, value=0)
    # 循环移位，使原点对齐左上角
    SobelYPadded = np.roll(
        np.roll(SobelYPadded, -(kSize//2), axis=0), -(kSize//2), axis=1)
    # 高斯滤波器的卷积核补零
    GaussianPadded = copyMakeBorder(
        GaussianKernel, top, bottom, left, right, borderType=BorderTypes.BORDER_CONSTANT, value=0)
    # 循环移位，使原点对齐左上角
    GaussianPadded = np.roll(
        np.roll(GaussianPadded, -(kSize//2), axis=0), -(kSize//2), axis=1)
    # 拉普拉斯滤波器的卷积核补零
    LaplacianPadded = copyMakeBorder(
        LaplacianKernel, top, bottom, left, right, borderType=BorderTypes.BORDER_CONSTANT, value=0)
    # 循环移位，使原点对齐左上角
    LaplacianPadded = np.roll(
        np.roll(LaplacianPadded, -(kSize//2), axis=0), -(kSize//2), axis=1)

    # 原图频谱（补零后）
    freqOrig = np.fft.fft2(imgOrigPadded)
    # 带高斯噪声图频谱（补零后）
    freqGaus = np.fft.fft2(imgGausPadded)
    # 带椒盐噪声图频谱（补零后）
    freqPep = np.fft.fft2(imgPepPadded)
    # x方向Sobel滤波器的卷积核频谱（补零后）
    freqSobelX = np.fft.fft2(SobelXPadded)
    # y方向Sobel滤波器的卷积核频谱（补零后）
    freqSobelY = np.fft.fft2(SobelYPadded)
    # 高斯滤波器的卷积核频谱（补零后）
    freqGaussian = np.fft.fft2(GaussianPadded)
    # 拉普拉斯滤波器的卷积核频谱（补零后）
    freqLaplacian = np.fft.fft2(LaplacianPadded)

    # 原图幅值谱（补零后）
    cv2.imwrite("./dst/magnitude_origin.png", logMagnitude(freqOrig))
    # 带高斯噪声图幅值谱（补零后）
    cv2.imwrite("./dst/magnitude_gaussian.png", logMagnitude(freqGaus))
    # 带椒盐噪声图幅值谱（补零后）
    cv2.imwrite("./dst/magnitude_pepper.png", logMagnitude(freqPep))
    # x方向Sobel滤波器的卷积核幅值谱（补零后）
    cv2.imwrite("./dst/magnitude_SobelXFilter.png", logMagnitude(freqSobelX))
    # y方向Sobel滤波器的卷积核幅值谱（补零后）
    cv2.imwrite("./dst/magnitude_SobelYFilter.png", logMagnitude(freqSobelY))
    # 高斯滤波器的卷积核幅值谱（补零后）
    cv2.imwrite("./dst/magnitude_GaussianFilter.png",
                logMagnitude(freqGaussian))
    # 拉普拉斯滤波器的卷积核幅值谱（补零后）
    cv2.imwrite("./dst/magnitude_LaplacianFilter.png",
                logMagnitude(freqLaplacian))

    # 原图幅值谱和x方向Sobel滤波器的卷积核幅值谱的乘积
    freqOrigSobelX = freqOrig*freqSobelX
    cv2.imwrite("./dst/magnitude_SobelXFiltered_origin.png",
                logMagnitude(freqOrigSobelX))
    # 原图幅值谱和y方向Sobel滤波器的卷积核幅值谱的乘积
    freqOrigSobelY = freqOrig*freqSobelY
    cv2.imwrite("./dst/magnitude_SobelYFiltered_origin.png",
                logMagnitude(freqOrigSobelY))
    # 原图幅值谱和高斯滤波器的卷积核幅值谱的乘积
    freqOrigGaussian = freqOrig*freqGaussian
    cv2.imwrite("./dst/magnitude_GaussianFiltered_origin.png",
                logMagnitude(freqOrigGaussian))
    # 原图幅值谱和拉普拉斯滤波器的卷积核幅值谱的乘积
    freqOrigLaplacian = freqOrig*freqLaplacian
    cv2.imwrite("./dst/magnitude_LaplacianFiltered_origin.png",
                logMagnitude(freqOrigLaplacian))
    # 带高斯噪声图幅值谱和x方向Sobel滤波器的卷积核幅值谱的乘积
    freqGausSobelX = freqGaus*freqSobelX
    cv2.imwrite("./dst/magnitude_SobelXFiltered_gaussian.png",
                logMagnitude(freqGausSobelX))
    # 带高斯噪声图幅值谱和y方向Sobel滤波器的卷积核幅值谱的乘积
    freqGausSobelY = freqGaus*freqSobelY
    cv2.imwrite("./dst/magnitude_SobelYFiltered_gaussian.png",
                logMagnitude(freqGausSobelY))
    # 带高斯噪声图幅值谱和高斯滤波器的卷积核幅值谱的乘积
    freqGausGaussian = freqGaus*freqGaussian
    cv2.imwrite("./dst/magnitude_GaussianFiltered_gaussian.png",
                logMagnitude(freqGausGaussian))
    # 带高斯噪声图幅值谱和拉普拉斯滤波器的卷积核幅值谱的乘积
    freqGausLaplacian = freqGaus*freqLaplacian
    cv2.imwrite("./dst/magnitude_LaplacianFiltered_gaussian.png",
                logMagnitude(freqGausLaplacian))

    # 原图经Sobel x方向滤波后的图像
    cv2.imwrite("./dst/3x3_Sobel_x_origin.png",
                freq2Space(freqOrigSobelX, kSize))
    # 原图经Sobel y方向滤波后的图像
    cv2.imwrite("./dst/3x3_Sobel_y_origin.png",
                freq2Space(freqOrigSobelY, kSize))
    # 原图经高斯滤波后的图像
    cv2.imwrite("./dst/3x3_Gaussian_origin.png",
                freq2Space(freqOrigGaussian, kSize))
    # 原图经拉普拉斯滤波后的图像
    cv2.imwrite("./dst/3x3_Laplacian_origin.png",
                freq2Space(freqOrigLaplacian, kSize))
    # 带高斯噪声图经Sobel x方向滤波后的图像
    cv2.imwrite("./dst/3x3_Sobel_x_gaussian.png",
                freq2Space(freqGausSobelX, kSize))
    # 带高斯噪声图经Sobel y方向滤波后的图像
    cv2.imwrite("./dst/3x3_Sobel_y_gaussian.png",
                freq2Space(freqGausSobelY, kSize))
    # 带高斯噪声图经高斯滤波后的图像
    cv2.imwrite("./dst/3x3_Gaussian_gaussian.png",
                freq2Space(freqGausGaussian, kSize))
    # 带高斯噪声图经拉普拉斯滤波后的图像
    cv2.imwrite("./dst/3x3_Laplacian_gaussian.png",
                freq2Space(freqGausLaplacian, kSize))


if __name__ == '__main__':
    main()
