'''

Packages:
# Name                    Version                   Build  Channel
blas                      1.0                         mkl
certifi                   2021.5.30        py36haa95532_0
icc_rt                    2019.0.0             h0cc432a_1
intel-openmp              2021.4.0          haa95532_3556
intelpython               2022.1.0                      0    intel
jpeg                      9e                   h2bbff1b_0
libblas                   3.9.0           1_h8933c1f_netlib    conda-forge
libcblas                  3.9.0           5_hd5c7e75_netlib    conda-forge
liblapack                 3.9.0           5_hd5c7e75_netlib    conda-forge
libopencv                 3.4.1                h875b8b8_3
libpng                    1.6.36                   vc14_2  [vc14]  intel
libtiff                   4.0.9                h36446d0_2
m2w64-gcc-libgfortran     5.3.0                         6
m2w64-gcc-libs            5.3.0                         7
m2w64-gcc-libs-core       5.3.0                         7
m2w64-gmp                 6.1.0                         2
m2w64-libwinpthread-git   5.0.0.4634.697f757               2
mkl                       2021.4.0           haa95532_640
mkl-service               2.4.0            py36h2bbff1b_0
mkl_fft                   1.0.14           py36ha68da19_1    intel
msys2-conda-epoch         20160418                      1
numpy                     1.11.3          py36h873a0b8_1207    conda-forge
numpy-base                1.17.0                  py36_13    intel
pip                       21.2.2           py36haa95532_0
py-opencv                 3.4.1            py36h1b0d24d_3
python                    3.6.13               h3758d61_0
setuptools                41.0.1                   py36_0    intel
six                       1.16.0             pyhd3eb1b0_1
sqlite                    3.38.3               h2bbff1b_0
tbb                       2021.5.2         vc14_intel_785  [vc14]  intel
tbb4py                    2021.5.2         py36_intel_785  [vc14]  intel
vc                        14.2                 h21ff451_1
vs2015_runtime            14.27.29016          h5e58377_2
wheel                     0.37.1             pyhd3eb1b0_0
wincertstore              0.2              py36h7fe50ca_0
zlib                      1.2.11.1         vc14hfa6e2cd_1  [vc14]  intel

------------------
System Information
------------------
      Time of this report: 4/6/2022, 12:24:06
             Machine name: ELITEBOOK
               Machine Id: {9131A80F-3366-4796-BD53-EA7FCCF25399}
         Operating System: Windows 11 专业版 64-bit (10.0, Build 22000) (22000.co_release.210604-1628)
                 Language: Chinese (Simplified) (Regional Setting: Chinese (Simplified))
      System Manufacturer: HP
             System Model: HP EliteBook 1050 G1
                     BIOS: Q72 Ver. 01.19.00 (type: UEFI)
                Processor: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz (12 CPUs), ~2.2GHz
                   Memory: 32768MB RAM
      Available OS Memory: 32574MB RAM
                Page File: 13557MB used, 23881MB available
              Windows Dir: C:\WINDOWS
          DirectX Version: DirectX 12
      DX Setup Parameters: Not found
         User DPI Setting: 120 DPI (125 percent)
       System DPI Setting: 120 DPI (125 percent)
          DWM DPI Scaling: UnKnown
                 Miracast: Available, with HDCP
Microsoft Graphics Hybrid: Supported
 DirectX Database Version: 1.3.5
           DxDiag Version: 10.00.22000.0001 64bit Unicode

---------------
Display Devices
---------------
           Card name: Intel(R) UHD Graphics 630
        Manufacturer: Intel Corporation
           Chip type: Intel(R) UHD Graphics Family
            DAC type: Internal
         Device Type: Full Device (POST)
          Device Key: Enum\PCI\VEN_8086&DEV_3E9B&SUBSYS_84E9103C&REV_00
       Device Status: 0180200A [DN_DRIVER_LOADED|DN_STARTED|DN_DISABLEABLE|DN_NT_ENUMERATOR|DN_NT_DRIVER]
 Device Problem Code: No Problem
 Driver Problem Code: Unknown
      Display Memory: 16415 MB
    Dedicated Memory: 128 MB
       Shared Memory: 16287 MB
        Current Mode: 1920 x 1080 (32 bit) (60Hz)
         HDR Support: Not Supported
    Display Topology: Internal
 Display Color Space: DXGI_COLOR_SPACE_RGB_FULL_G22_NONE_P709
     Color Primaries: Red(0.639648,0.330078), Green(0.299805,0.599609), Blue(0.149414,0.059570), White Point(0.312500,0.329102)
   Display Luminance: Min Luminance = 0.500000, Max Luminance = 270.000000, MaxFullFrameLuminance = 270.000000
        Monitor Name: Generic PnP Monitor
       Monitor Model: unknown
          Monitor Id: LGD05A9
         Native Mode: 1920 x 1080(p) (59.977Hz)
         Output Type: Internal
Monitor Capabilities: HDR Not Supported
Display Pixel Format: DISPLAYCONFIG_PIXELFORMAT_32BPP
      Advanced Color: Not Supported
         Driver Name: C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igdumdim64.dll,C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igd10iumd64.dll,C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igd10iumd64.dll,C:\WINDOWS\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_1dc9fc8d5e442f6a\igd12umd64.dll
 Driver File Version: 30.00.0101.1340 (English)
      Driver Version: 30.0.101.1340
         DDI Version: 12
      Feature Levels: 12_1,12_0,11_1,11_0,10_1,10_0,9_3,9_2,9_1
        Driver Model: WDDM 3.0
 Hardware Scheduling: DriverSupportState:AlwaysOff Enabled:False
 Graphics Preemption: Triangle
  Compute Preemption: Thread
            Miracast: Supported
      Detachable GPU: No
 Hybrid Graphics GPU: Integrated
      Power P-states: Not Supported
      Virtualization: Paravirtualization
          Block List: DISABLE_HWSCH
  Catalog Attributes: Universal:False Declarative:True
   Driver Attributes: Final Retail
    Driver Date/Size: 2022/2/3 8:00:00, 1702664 bytes
         WHQL Logo'd: Yes
     WHQL Date Stamp: Unknown
   Device Identifier: {D7B78E66-7DDB-11CF-B076-8CA4AFC2D335}
           Vendor ID: 0x8086
           Device ID: 0x3E9B
           SubSys ID: 0x84E9103C
         Revision ID: 0x0000
  Driver Strong Name: oem121.inf:5f63e53429d61c21:iCFL_w10_DS:30.0.101.1340:PCI\VEN_8086&DEV_3E9B
      Rank Of Driver: 00CF2001
         Video Accel: ModeMPEG2_A ModeMPEG2_C ModeWMV9_C ModeVC1_C
         DXVA2 Modes: DXVA2_ModeMPEG2_VLD  DXVA2_ModeMPEG2_IDCT  DXVA2_ModeVC1_D2010  {E07EC519-E651-4CD6-AC84-1370CCEEC851}  {BCC5DB6D-A2B6-4AF0-ACE4-ADB1F787BC89}  DXVA2_ModeWMV9_IDCT  DXVA2_ModeVC1_IDCT  DXVA2_ModeH264_VLD_NoFGT  DXVA2_ModeH264_VLD_Stereo_Progressive_NoFGT  DXVA2_ModeH264_VLD_Stereo_NoFGT  DXVA2_ModeH264_VLD_Multiview_NoFGT  {C528916C-C0AF-4645-8CB2-372B6D4ADC2A}  {91CD2D6E-897B-4FA1-B0D7-51DC88010E0A}  DXVA2_ModeVP8_VLD  {442B942A-B4D9-4940-BC45-A882E5F919F3}  {97688186-56A8-4094-B543-FC9DAAA49F4B}  {1424D4DC-7CF5-4BB1-9CD7-B63717A72A6B}  {C346E8A3-CBED-4D27-87CC-A70EB4DC8C27}  {FFC79924-5EAF-4666-A736-06190F281443}  {2364D06A-F67F-4186-AED0-62B99E1784F1}  {464BDB3C-91C4-4E9B-896F-225496AC4ED6}  {28566328-F041-4466-8B14-8F5831E78F8B}  {6B4A94DB-54FE-4AE1-9BE4-7A7DAD004600}  {8C56EB1E-2B47-466F-8D33-7DBCD63F3DF2}  DXVA2_ModeHEVC_VLD_Main  {75FC75F7-C589-4A07-A25B-72E03B0383B3}  DXVA2_ModeHEVC_VLD_Main10  {07CFAFFB-5A2E-4B99-B62A-E4CA53B6D5AA}  DXVA2_ModeVP9_VLD_Profile0  DXVA2_ModeVP9_VLD_10bit_Profile2  {76988A52-DF13-419A-8E64-FFCF4A336CF5}  {80A3A7BD-89D8-4497-A2B8-2126AF7E6EB8}  {50925B7B-E931-4978-A12A-586630F095F9}  {B69C20E0-2508-8790-0305-875499E0A2D0}  {49761BEC-4B63-4349-A5FF-87FFDF088466}
   Deinterlace Caps: {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(UYVY,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(UYVY,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(UYVY,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(YV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(YV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(NV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(NV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(NV12,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC1,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC1,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC1,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC2,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC3,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC3,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC3,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
                     {BF752EF6-8CC4-457A-BE1B-08BD1CAEEE9F}: Format(In/Out)=(IMC4,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_EdgeFiltering
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(IMC4,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend DeinterlaceTech_BOBVerticalStretch
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC4,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY VideoProcess_AlphaBlend
        D3D9 Overlay: Supported
             DXVA-HD: Supported
        DDraw Status: Enabled
          D3D Status: Enabled
          AGP Status: Enabled
       MPO MaxPlanes: 3
            MPO Caps: RGB,YUV,BILINEAR,HIGH_FILTER,STRETCH_YUV,STRETCH_RGB,IMMEDIATE,HDR (MPO3)
         MPO Stretch: 5.000X - 0.334X
     MPO Media Hints: colorspace Conversion
         MPO Formats: NV12,YUY2,R16G16B16A16_FLOAT,R10G10B10A2_UNORM,R8G8B8A8_UNORM,B8G8R8A8_UNORM
    PanelFitter Caps: RGB,YUV,BILINEAR,HIGH_FILTER,STRETCH_YUV,STRETCH_RGB,IMMEDIATE,HDR (MPO3)
 PanelFitter Stretch: 5.000X - 0.334X
   Component Drivers:
             Driver Name: Unknown
          Driver Version: Unknown
             Driver Date: Unknown
         Driver Provider: Unknown
      Catalog Attributes: N/A
             Driver Name: Unknown
          Driver Version: Unknown
             Driver Date: Unknown
         Driver Provider: Unknown
      Catalog Attributes: N/A

           Card name: NVIDIA GeForce GTX 1050 with Max-Q Design
        Manufacturer: NVIDIA
           Chip type: NVIDIA GeForce GTX 1050 with Max-Q Design
            DAC type: Integrated RAMDAC
         Device Type: Full Device
          Device Key: Enum\PCI\VEN_10DE&DEV_1C8D&SUBSYS_84E9103C&REV_A1
       Device Status: 0180200A [DN_DRIVER_LOADED|DN_STARTED|DN_DISABLEABLE|DN_NT_ENUMERATOR|DN_NT_DRIVER]
 Device Problem Code: No Problem
 Driver Problem Code: Unknown
      Display Memory: 20306 MB
    Dedicated Memory: 4019 MB
       Shared Memory: 16287 MB
        Current Mode: Unknown
         HDR Support: Unknown
    Display Topology: Unknown
 Display Color Space: Unknown
     Color Primaries: Unknown
   Display Luminance: Unknown
         Driver Name: C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll,C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll,C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll,C:\WINDOWS\System32\DriverStore\FileRepository\nvbli.inf_amd64_c1e7d53215dee65d\nvldumdx.dll
 Driver File Version: 30.00.0015.1006 (English)
      Driver Version: 30.0.15.1006
         DDI Version: 12
      Feature Levels: 12_1,12_0,11_1,11_0,10_1,10_0,9_3,9_2,9_1
        Driver Model: WDDM 3.0
 Hardware Scheduling: DriverSupportState:Stable Enabled:True
 Graphics Preemption: Pixel
  Compute Preemption: Dispatch
            Miracast: Not Supported by Graphics driver
      Detachable GPU: No
 Hybrid Graphics GPU: Discrete
      Power P-states: Not Supported
      Virtualization: Paravirtualization
          Block List: No Blocks
  Catalog Attributes: Universal:False Declarative:True
   Driver Attributes: Final Retail
    Driver Date/Size: 2021/8/24 8:00:00, 1056920 bytes
         WHQL Logo'd: Yes
     WHQL Date Stamp: Unknown
   Device Identifier: Unknown
           Vendor ID: 0x10DE
           Device ID: 0x1C8D
           SubSys ID: 0x84E9103C
         Revision ID: 0x00A1
  Driver Strong Name: oem21.inf:0f066de303554110:Section032:30.0.15.1006:pci\ven_10de&dev_1c8d&subsys_84e9103c
      Rank Of Driver: 00CF0001
         Video Accel: Unknown
         DXVA2 Modes: {86695F12-340E-4F04-9FD3-9253DD327460}  DXVA2_ModeMPEG2_VLD  {6F3EC719-3735-42CC-8063-65CC3CB36616}  DXVA2_ModeVC1_D2010  DXVA2_ModeVC1_VLD  {32FCFE3F-DE46-4A49-861B-AC71110649D5}  DXVA2_ModeH264_VLD_Stereo_Progressive_NoFGT  DXVA2_ModeH264_VLD_Stereo_NoFGT  DXVA2_ModeH264_VLD_NoFGT  DXVA2_ModeHEVC_VLD_Main  DXVA2_ModeHEVC_VLD_Main10  {20BB8B0A-97AA-4571-8E99-64E60606C1A6}  {15DF9B21-06C4-47F1-841E-A67C97D7F312}  DXVA2_ModeMPEG4pt2_VLD_Simple  DXVA2_ModeMPEG4pt2_VLD_AdvSimple_NoGMC  {9947EC6F-689B-11DC-A320-0019DBBC4184}  {33FCFE41-DE46-4A49-861B-AC71110649D5}  DXVA2_ModeVP9_VLD_Profile0  DXVA2_ModeVP9_VLD_10bit_Profile2  {DDA19DC7-93B5-49F5-A9B3-2BDA28A2CE6E}  {6AFFD11E-1D96-42B1-A215-93A31F09A53D}  {914C84A3-4078-4FA9-984C-E2F262CB5C9C}
      Deinterlace Caps: n/a
        D3D9 Overlay: Unknown
             DXVA-HD: Unknown
        DDraw Status: Enabled
          D3D Status: Enabled
          AGP Status: Enabled
       MPO MaxPlanes: 0
            MPO Caps: Not Supported
         MPO Stretch: Not Supported
     MPO Media Hints: Not Supported
         MPO Formats: Not Supported
    PanelFitter Caps: Not Supported
 PanelFitter Stretch: Not Supported

-------------
Sound Devices
-------------
            Description: 扬声器 (Conexant ISST Audio)
 Default Sound Playback: Yes
 Default Voice Playback: Yes
            Hardware ID: INTELAUDIO\FUNC_01&VEN_14F1&DEV_20D0&SUBSYS_103C84E9&REV_1000
        Manufacturer ID: N/A
             Product ID: N/A
                   Type: N/A
            Driver Name: CHDRT64ISST.sys
         Driver Version: 9.0.278.150 (Chinese (Simplified))
      Driver Attributes: Final Retail
            WHQL Logo'd: Yes
          Date and Size: 2021/11/18 8:00:00, 2521920 bytes
            Other Files:
        Driver Provider: Conexant
         HW Accel Level: Emulation Only
              Cap Flags: 0xF1F
    Min/Max Sample Rate: 100, 200000
Static/Strm HW Mix Bufs: 1, 0
 Static/Strm HW 3D Bufs: 0, 0
              HW Memory: 0
       Voice Management: No
 EAX(tm) 2.0 Listen/Src: No, No
   I3DL2(tm) Listen/Src: No, No
Sensaura(tm) ZoomFX(tm): No

---------------------
Sound Capture Devices
---------------------
            Description: 麦克风 (Conexant ISST Audio)
  Default Sound Capture: Yes
  Default Voice Capture: Yes
            Driver Name: CHDRT64ISST.sys
         Driver Version: 9.0.278.150 (Chinese (Simplified))
      Driver Attributes: Final Retail
          Date and Size: 2021/11/18 8:00:00, 2521920 bytes
              Cap Flags: 0x1
           Format Flags: 0xFFFFF

-------------------
DirectInput Devices
-------------------
      Device Name: 鼠标
         Attached: 1
    Controller ID: n/a
Vendor/Product ID: n/a
        FF Driver: n/a

      Device Name: 键盘
         Attached: 1
    Controller ID: n/a
Vendor/Product ID: n/a
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: HP Wireless Button Driver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x0001, 0x0001
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: HIDI2C Device
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x06CB, 0xCD46
        FF Driver: n/a

      Device Name: USB Receiver
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x046D, 0xC53F
        FF Driver: n/a

      Device Name: HIDI2C Device
         Attached: 1
    Controller ID: 0x0
Vendor/Product ID: 0x06CB, 0xCD46
        FF Driver: n/a

Poll w/ Interrupt: No

-----------
USB Devices
-----------
+ USB 根集线器(USB 3.0)
| Vendor/Product ID: 0x8086, 0xA36D
| Matching Device ID: USB\ROOT_HUB30
| Service: USBHUB3
| Driver: USBHUB3.SYS, 8/1/2021 11:33:15, 696656 bytes
|
+-+ USB Composite Device
| | Vendor/Product ID: 0x046D, 0xC53F
| | Location: Port_#0005.Hub_#0001
| | Matching Device ID: USB\COMPOSITE
| | Service: usbccgp
| | Driver: usbccgp.sys, 6/5/2021 20:04:46, 221512 bytes
| |
| +-+ USB 输入设备
| | | Vendor/Product ID: 0x046D, 0xC53F
| | | Location: 0000.0014.0000.005.000.000.000.000.000
| | | Matching Device ID: USB\Class_03&SubClass_01
| | | Service: HidUsb
| | | Driver: hidusb.sys, 6/5/2021 20:04:46, 73728 bytes
| | | Driver: hidclass.sys, 6/5/2021 20:04:46, 274432 bytes
| | | Driver: hidparse.sys, 6/5/2021 20:04:46, 77824 bytes
| | |
| | +-+ HID Keyboard Device
| | | | Vendor/Product ID: 0x046D, 0xC53F
| | | | Matching Device ID: HID_DEVICE_SYSTEM_KEYBOARD
| | | | Service: kbdhid
| | | | Driver: kbdhid.sys, 6/5/2021 20:04:46, 69632 bytes
| | | | Driver: kbdclass.sys, 6/5/2021 20:04:46, 90424 bytes
| | |
| +-+ USB 输入设备
| | | Vendor/Product ID: 0x046D, 0xC53F
| | | Location: 0000.0014.0000.005.000.000.000.000.000
| | | Matching Device ID: USB\Class_03&SubClass_01
| | | Service: HidUsb
| | | Driver: hidusb.sys, 6/5/2021 20:04:46, 73728 bytes
| | | Driver: hidclass.sys, 6/5/2021 20:04:46, 274432 bytes
| | | Driver: hidparse.sys, 6/5/2021 20:04:46, 77824 bytes
| | |
| | +-+ HID-compliant mouse
| | | | Vendor/Product ID: 0x046D, 0xC53F
| | | | Matching Device ID: HID_DEVICE_SYSTEM_MOUSE
| | | | Service: mouhid
| | | | Driver: mouhid.sys, 6/5/2021 20:04:46, 65536 bytes
| | | | Driver: mouclass.sys, 6/5/2021 20:04:46, 90448 bytes

------------
PS/2 Devices
------------
+ Standard 101/102-Key or Microsoft Natural PS/2 Keyboard for HP Hotkey Support
| Matching Device ID: ACPI\HPQ8002
| Upper Filters: HpqKbFiltr
| Service: i8042prt
| Driver: HpqKbFiltr.sys, 10/30/2021 14:34:06, 54688 bytes
| Driver: i8042prt.sys, 6/5/2021 20:04:46, 155648 bytes
| Driver: kbdclass.sys, 6/5/2021 20:04:46, 90424 bytes
|
+ Synaptics HID ClickPad
| Vendor/Product ID: 0x06CB, 0x0000
| Matching Device ID: HID\SYNA307B&Col01
| Upper Filters: SynTP
| Service: mouhid
| Driver: SynTP.sys, 1/20/2021 23:58:02, 762256 bytes
| Driver: SynTPEnh.exe, 1/20/2021 23:58:04, 4287888 bytes
| Driver: SynTPRes.dll, 1/20/2021 23:58:02, 19816336 bytes
| Driver: SynTPAPI.dll, 1/20/2021 23:58:00, 275344 bytes
| Driver: SynCOM.dll, 1/20/2021 23:57:56, 810384 bytes
| Driver: SynTPEnhService.exe, 1/20/2021 23:58:00, 342416 bytes
| Driver: mouhid.sys, 6/5/2021 20:04:46, 65536 bytes
| Driver: mouclass.sys, 6/5/2021 20:04:46, 90448 bytes
|
+ PS/2 兼容鼠标
| Matching Device ID: *PNP0F13
| Service: i8042prt
| Driver: mouclass.sys, 6/5/2021 20:04:46, 90448 bytes
| Driver: i8042prt.sys, 6/5/2021 20:04:46, 155648 bytes

------------------------
Disk & DVD/CD-ROM Drives
------------------------
      Drive: C:
 Free Space: 359.5 GB
Total Space: 952.9 GB
File System: NTFS
      Model: Intel Raid 1 Volume

'''



import numpy as np
import cv2


def stitch(imgA: np.ndarray, imgB: np.ndarray, homoMatB2A: np.ndarray,
           ratioA: float = 0.5, ratioB: float = -1, brightnessRatioB: float = 1.0) -> np.ndarray:
    '''fusing two images with the homography matrix'''

    cornerMat = np.array([[0, imgB.shape[1]-1, imgB.shape[1]-1, 0],
                          [0, 0, imgB.shape[0]-1, imgB.shape[0]-1],
                          [1, 1, 1, 1]])  # corner coordinates on imgB
    '''
       (0,0)________(0, w-1)
           |        |
           |________|
    (h-1,0)         (h-1,w-1)
    '''

    cornerNewMat = np.dot(homoMatB2A, cornerMat)
    '''[s1*x1, s2*x2, s3*x3, s4*x4;
        s1*y1, s2*y2, s3*y3, s4*y4;
        s1   , s2   , s3   , s4]
    '''
    # get transformed x coordinates of corners on imgB
    cornerNewMat[0, :] /= cornerNewMat[2, :]
    # get transformed y coordinates of corners on imgB
    cornerNewMat[1, :] /= cornerNewMat[2, :]
    minX = int(np.floor(np.min(cornerNewMat[0, :])))  # get min x coord
    maxX = int(np.ceil(np.max(cornerNewMat[0, :])))  # get max x coord
    minY = int(np.floor(np.min(cornerNewMat[1, :])))  # get min y coord
    maxY = int(np.ceil(np.max(cornerNewMat[1, :])))  # get min y coord

    if minX < 0:  # if min x coord is less than zero
        offsetX = -minX  # calculate offset
    else:
        offsetX = 0  # offset set to zero
    homoMatB2A[0, 2] += offsetX  # avoid negative coordinates
    imWd = maxX+offsetX+1  # calculate new image width

    if minY < 0:  # if min y coord is less than zero
        offsetY = -minY  # calculate offset
    else:
        offsetY = 0  # offset set to zero
    homoMatB2A[1, 2] += offsetY  # avoid negative coordinates
    imHt = maxY+offsetY+1  # calculate new image height

    # perspective transform imgB with offset
    imgBWarp = cv2.warpPerspective(
        imgB, homoMatB2A, (imWd, imHt), flags=cv2.INTER_LINEAR, borderMode=cv2.BORDER_CONSTANT, borderValue=0)

    tA = np.array([[1, 0, offsetX],
                   [0, 1, offsetY]], dtype=np.float32)  # calculate transformation matrix to apply offset on imgA
    # translate imgA with offset
    imgATr = cv2.warpAffine(imgA, tA, (imWd, imHt))

    dst = np.empty_like(imgATr)  # allocate memory for return value

    imgBWarp = cv2.convertScaleAbs(
        imgBWarp, alpha=brightnessRatioB, beta=0)  # brighten imgB

    imgATrNz = imgATr.any(axis=-1)  # nonzero elements in imgATr
    imgBWarpNz = imgBWarp.any(axis=-1)  # nonzero elements in imgBWarp
    overlap = np.bitwise_and(imgATrNz, imgBWarpNz)  # overlapping part of two

    if ratioB < 0:
        ratioB = 1-ratioA  # ratioB defaults to ratioA's complement

    imgATr[overlap] = imgATr[overlap]*ratioA  # apply ratio
    imgBWarp[overlap] = imgBWarp[overlap]*ratioB  # apply ratio
    dst = imgATr+imgBWarp  # linear fusion

    return dst  # return result


def main():
    imgA = cv2.imread('./src/A.png')  # read imgA
    imgB = cv2.imread('./src/B.png')  # read imgB

    # initiate SIFT detector
    SIFT = cv2.xfeatures2d.SIFT_create(nfeatures=0, nOctaveLayers=3,
                                       contrastThreshold=0.04, edgeThreshold=10, sigma=1.6)
    # find the keypoints and descriptors in imgA with SIFT
    kpASIFT, desASIFT = SIFT.detectAndCompute(imgA, None)
    # find the keypoints and descriptors in imgB with SIFT
    kpBSIFT, desBSIFT = SIFT.detectAndCompute(imgB, None)
    # create BFMatcher object, using L2 norm and enable cross check
    bfSIFT = cv2.BFMatcher(cv2.NORM_L2, crossCheck=False)
    # match descriptors, find the k best matches
    mchSIFT = bfSIFT.knnMatch(desASIFT, desBSIFT, k=2)
    # store all the good matches as per Lowe's ratio test.
    goodMchSIFT = []
    for m, n in mchSIFT:
        # the best match shold be much better than the second best
        if m.distance < 0.7*n.distance:
            goodMchSIFT.append(m)
    # draw matches
    matchedSIFT = cv2.drawMatches(imgA, kpASIFT, imgB, kpBSIFT,
                                  goodMchSIFT, None, matchColor=(0, 255, 0),
                                  flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)
    cv2.imwrite("./dst/SIFT_match.png", matchedSIFT)  # save result

    bPtsSIFT = np.array(
        [kpBSIFT[m.trainIdx].pt for m in goodMchSIFT]).reshape(-1, 1, 2)  # good matches on imgB
    aPtsSIFT = np.array(
        [kpASIFT[m.queryIdx].pt for m in goodMchSIFT]).reshape(-1, 1, 2)  # good matches on imgA
    # find a perspective transformation with RANSAC filtering method
    homoSIFT, maskSIFT = cv2.findHomography(
        bPtsSIFT, aPtsSIFT, cv2.RANSAC, 5.0)
    # draw filtered matches
    filteredSIFT = cv2.drawMatches(imgA, kpASIFT, imgB, kpBSIFT,
                                   goodMchSIFT, None, matchColor=(0, 255, 0), matchesMask=maskSIFT.ravel().tolist(),
                                   flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)
    cv2.imwrite("./dst/SIFT_ransac.png", filteredSIFT)  # save result

    np.set_printoptions(precision=2)  # set fignificant figures
    print(homoSIFT)  # print homography matrix

    stitchedSIFT = stitch(imgA, imgB, homoSIFT,
                          ratioA=0.9, brightnessRatioB=1.2)  # stitch two images
    cv2.imwrite("./dst/SIFT_stitch.png", stitchedSIFT)  # save result

    # initiate SURF detector
    SURF = cv2.xfeatures2d.SURF_create(
        hessianThreshold=100, nOctaves=4, nOctaveLayers=3, extended=False, upright=False)
    # find the keypoints and descriptors in imgA with SURF
    kpASURF, desASURF = SURF.detectAndCompute(imgA, None)
    # find the keypoints and descriptors in imgB with SURF
    kpBSURF, desBSURF = SURF.detectAndCompute(imgB, None)
    # create BFMatcher object, using L2 norm and enable cross check
    bfSURF = cv2.BFMatcher(cv2.NORM_L2, crossCheck=False)
    # match descriptors, find the k best matches
    mchSURF = bfSURF.knnMatch(desASURF, desBSURF, k=2)
    # store all the good matches as per Lowe's ratio test.
    goodMchSURF = []
    for m, n in mchSURF:
        # the best match shold be much better than the second best
        if m.distance < 0.7*n.distance:
            goodMchSURF.append(m)
    # draw matches
    matchedSURF = cv2.drawMatches(imgA, kpASURF, imgB, kpBSURF,
                                  goodMchSURF, None, matchColor=(0, 255, 0),
                                  flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)
    cv2.imwrite("./dst/SURF_match.png", matchedSURF)  # save result

    bPtsSURF = np.array(
        [kpBSURF[m.trainIdx].pt for m in goodMchSURF]).reshape(-1, 1, 2)  # good matches on imgB
    aPtsSURF = np.array(
        [kpASURF[m.queryIdx].pt for m in goodMchSURF]).reshape(-1, 1, 2)  # good matches on imgA
    # find a perspective transformation with RANSAC filtering method
    homoSURF, maskSURF = cv2.findHomography(
        bPtsSURF, aPtsSURF, cv2.RANSAC, 5.0)
    # draw filtered matches
    filteredSURF = cv2.drawMatches(imgA, kpASURF, imgB, kpBSURF,
                                   goodMchSURF, None, matchColor=(0, 255, 0), matchesMask=maskSURF.ravel().tolist(),
                                   flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)
    cv2.imwrite("./dst/SURF_ransac.png", filteredSURF)  # save result

    np.set_printoptions(precision=2)  # set fignificant figures
    print(homoSURF)  # print homography matrix

    stitchedSURF = stitch(imgA, imgB, homoSURF,
                          ratioA=0.9, brightnessRatioB=1.2)  # stitch two images
    cv2.imwrite("./dst/SURF_stitch.png", stitchedSURF)  # save result

    # initiate ORB detector
    ORB = cv2.ORB_create(nfeatures=500,	scaleFactor=1.2, nlevels=8, edgeThreshold=31,
                         firstLevel=0, WTA_K=2, scoreType=cv2.ORB_HARRIS_SCORE, patchSize=31, fastThreshold=20)
    # find the keypoints and descriptors in imgA with ORB
    kpAORB, desAORB = ORB.detectAndCompute(imgA, None)
    # find the keypoints and descriptors in imgB with ORB
    kpBORB, desBORB = ORB.detectAndCompute(imgB, None)
    # create BFMatcher object, using hamming norm and enable cross check
    bfORB = cv2.BFMatcher(cv2.NORM_HAMMING, crossCheck=False)
    # match descriptors, find the k best matches
    mchORB = bfORB.knnMatch(desAORB, desBORB, k=2)
    # store all the good matches as per Lowe's ratio test.
    goodMchORB = []
    for m, n in mchORB:
        # the best match shold be much better than the second best
        if m.distance < 0.7*n.distance:
            goodMchORB.append(m)
    # draw matches
    matchedORB = cv2.drawMatches(imgA, kpAORB, imgB, kpBORB,
                                 goodMchORB, None, matchColor=(0, 255, 0),
                                 flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)
    cv2.imwrite("./dst/ORB_match.png", matchedORB)  # save result

    bPtsORB = np.array(
        [kpBORB[m.trainIdx].pt for m in goodMchORB]).reshape(-1, 1, 2)  # good matches on imgB
    aPtsORB = np.array(
        [kpAORB[m.queryIdx].pt for m in goodMchORB]).reshape(-1, 1, 2)  # good matches on imgA
    # find a perspective transformation with RANSAC filtering method
    homoORB, maskORB = cv2.findHomography(
        bPtsORB, aPtsORB, cv2.RANSAC, 5.0)
    # draw filtered matches
    filteredORB = cv2.drawMatches(imgA, kpAORB, imgB, kpBORB,
                                  goodMchORB, None, matchColor=(0, 255, 0), matchesMask=maskORB.ravel().tolist(),
                                  flags=cv2.DrawMatchesFlags_NOT_DRAW_SINGLE_POINTS)
    cv2.imwrite("./dst/ORB_ransac.png", filteredORB)  # save result

    np.set_printoptions(precision=2)  # set fignificant figures
    print(homoORB)  # print homography matrix

    stitchedORB = stitch(imgA, imgB, homoORB,
                         ratioA=0.9, brightnessRatioB=1.2)  # stitch two images
    cv2.imwrite("./dst/ORB_stitch.png", stitchedORB)  # save result


if __name__ == '__main__':
    main()
